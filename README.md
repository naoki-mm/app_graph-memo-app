# PLOTemo (プロッテモ)

#### グラフ画像のデータ読み取りを効率化 & メモ管理 アプリ

- 画像化されたグラフのデータポイントを**効率的に読み取る**。
- クラウド上にメモのように**保存・一括管理**が可能。
- 検索で必要なデータが**すぐに見つかり**、CSVダウンロードでデータが**すぐに使える**。

https://user-images.githubusercontent.com/86902324/149649147-c11c41d5-b013-4bbd-8697-e4087ab39b93.mp4

#### アプリURL：https://plot-memo-app.com/

- 「ゲストログイン」 or 「機能を試す」ボタンで登録せずに機能が試せます。
- スマホ対応しています。

[Qiita記事紹介](https://qiita.com/hinanam3/items/51f608ea796ad535763e)

## 制作背景

前職 (ハードウェアエンジニア) の時に、設計などで使うためにグラフ画像を読み取る機会多くありました。  
しかし、仕事で使っていた画像読み取りアプリは下記のような使いにくさを感じていました。

- UIの問題で初めての人には使いにくい。
- windows専用のデスクトップアプリで異なるデバイスからアクセスできない。
- 一度読み取ったデータはアプリ上で保存できない。(別管理しないと後で確認できない & 再利用できない。)
- 読み取ったデータがすぐに使える形式ではなく、Excelなどで使う場合は加工して使う必要があった。

以上を踏まえ、`UIを意識`しながら、下記の利便性を組み合わせた`グラフ画像の読み取り効率化`アプリを作成しました。  
`webで利用可能` + `メモ形式で再利用可能` + `検索、CSVダウンロードですぐに使える`

## 使用技術

### フロントエンド

- HTML、CSS、Sass
- MDBootstrap　4.19.1
- Vue.js　2.6.14

### バックエンド

- PHP 7.4.1
- Laravel 6.20.34

### インフラ

- Docker 20.10.7 / docker-compose 1.29.2 (開発環境)
- AWS (EC2, ALB, ACM, S3, RDS, Route53, VPC, IAM)
- MySQL 8.0.26
- nginx 1.20.0

### その他

- Git / GitHub
- VSCode
- Canva (ロゴや図の作成)
- Draw.io (ER図、インフラ構成図の作成)
- Sequel Ace (DBクライアントツール)

## ER図

![PF_ER図](https://user-images.githubusercontent.com/86902324/149616947-75f9de92-8928-4748-9574-9dfd88c2c440.png)

## インフラ構成図

![インフラ構成図](https://user-images.githubusercontent.com/86902324/149628551-1a1baaa2-0ef8-48f8-ab0b-e23a8a156622.png)

## 主な機能

### グラフ読み取り、プロットメモの作成

アップロードされたグラフ画像を表示し、軸設定後に読み取りたいポイントをクリックして値を取得 & 保存する。

1. ドラッグ&ドロップ or ファイル選択で画像を読み込む。
2. X軸、Y軸の最小値・最大値の設定。
3. グラフ画像上で読み取りたいポイントをクリックして値を取得。
4. メモを記入し、保存する。

https://user-images.githubusercontent.com/86902324/149666717-c3a13d01-9bbe-4111-b166-0497f8ec7bbe.mp4


### CSVダウンロード機能 

1. CSVダウンロードをクリックする。
2. 読み取ったデータがダウンロードされ、データを加工せずにグラフ作成できる。

https://user-images.githubusercontent.com/86902324/149668591-79c2c113-26cc-4016-bae9-4f8a5e000876.mp4


### 検索機能

- 日時のソート
- お気に入り検索
- タグ検索
- キーワード検索 (スペースでOR検索)

https://user-images.githubusercontent.com/86902324/149668458-dae10737-bdd6-4628-a0ae-5107a973104f.mp4


### ゴミ箱機能

- ゴミ箱一覧表示
- 復元
- 完全削除

https://user-images.githubusercontent.com/86902324/149668346-cf0371f4-c25d-4541-9b4d-1bca1354f223.mp4

### アカウント設定機能

- プロフィールの変更 (ニックネーム、アバター画像)
- メールアドレスの変更
- パスワードの変更
- 退会確認・処理

https://user-images.githubusercontent.com/86902324/149669427-50531378-f27e-4db2-a837-baf0623a3a2c.mp4


## 機能一覧

### 認証機能

- 新規登録
- ログイン / ログアウト
- ゲストユーザーログイン
    - 全ての操作は可能だが、一部のDB更新は無効化 (条件分岐でリダイレクトしてメッセージを返す)
- バリデーション (Laravel)

### 認可機能

- ログインユーザーと異なるユーザーの情報にアクセスした際に403(権限)エラーレスポンスを返す。

### アカウント設定機能

- CRUD処理
- プロフィール (画像、名前) 編集 (intervention、imageとGDライブラリ)
- プロフィール画像のプレビュー　(Vue)
- メールアドレス、パスワード編集
- 退会処理と確認のUI (Laravel、 Vue)
- バリデーション (Laravel)

### グラフ画像のプロット & メモ機能

- プロットメモ一覧表示
    - Canvas画像とグラフ画像を重ねて配置 (Sass)
    - ページネーション (Laravel)
    - ツールチップ(マウスホバー時にヒントの表示)
    - タグ機能 (vue-tags-input, Vue)
    - お気に入り機能 (axios, Vue, Laravel)
    - N + 1問題の解消
  
- プロットメモの新規作成 / 編集機能
    - グラフ画像アップロード (Vue, Laravel, axios, Canvas API)
        - ドラッグ&ドロップ or 選択 
        - 画像をCanvasに表示
        - 画像の保持 (非同期通信でサーバーに保存&セッションで名前データの保持)
        - 画像のバリデーション (非同期通信でエラーレスポンスを取得)
    
    - 軸設定機能 (Vue, Canvas API)
        - Canvasのレスポンシブ対応 (Canvasサイズを取得して計算に用いる)
        - x軸、y軸の設定
        - 軸設定の誤操作防止モーダル
        - 設定完了時のチェックマーク
        - クリックイベント毎に異なる表記をCanvasへ描画
        - 軸設定のリセット機能
    
    - プロットデータの読み取り機能 (Vue, Laravel, axios, Canvas API)
        - クリックポイントをCanvasへ描画
        - クリックポイント値を軸設定した値に換算して取得してテキストエリアに表示
        - クリックデータとテキストエリアの表示の双方向バイディング
        - テキストエリアの更新イベントを検知して再描画
        - テキストエリアの値を規則性を持たせ表示 (桁数、カンマ区切り、改行)
        - プロットデータを画像化して、非同期でサーバーへ保存
        - 座標の角度補正 (画像が傾いている場合でも座標の角度を補正する)

    - メモ作成機能 (vue-tags-input, Laravel)
        - タイトル、メモ、タグの保存
        - canvasデータとplotデータの保存
        - バリデーション
        - バリデーション後のold値、画像の保持
        - 保存タブのcanvasの誤操作防止モーダル

### CSVダウンロード機能

- データベースのプロットデータをすぐに使える形に加工

### メモ検索機能

- 検索結果が見つからなかったことを明示的に表示
- 下記をAND条件の絞り込み (セッションで条件を保持)
    - お気に入り有無
    - タグ名
    - ソート
- ページネーション (コレクションクラスの型のため LengthAwarePaginatorクラス を使用)  
- キーワード検索機能 (スペース区切りで or条件 が設定可能)

### ゴミ箱機能

- メモをゴミ箱に移動 (論理削除)
- ゴミ箱にあるメモの一覧表示 (論理削除されたメモを表示)
- ゴミ箱が空の状態を明示的に表示
- リストア、完全削除 (物理削除)

### その他

- レスポンシブ対応
- パンくずリスト
- サクセス、エラーのトースト通知 (vue-toasted Vue)

## 今後実装したい機能

今回は**主軸となる機能を優先的に実装**して、余計な機能は省きました。
今後は更なる利便性や、保守性などを考慮して下記の機能追加を考えております。

- Canvas内での虫眼鏡機能
- プロットポインタの色設定機能(カラーピッカーによる色設定&DB保存)
- データ系列の追加機能 (DBのカラムは追加済み)
- プロット表示データのソート機能
- 多様なグラフに対応、片対数・両対数軸のグラフに対応
- チーム設定機能
　 (社内で使うことを想定してチーム内でグラフの共有・アクセス権設定機能)
- タグ管理機能
- 軸の自動検出、プロットデータの自動プロット
 　(PHP、JSのライブラリは使えそうなものなし。GoogleのAIのAPIのサンプルを見たが、アプリとの相性が悪かった。Pythonは出来そうなライブラリがあった。)


